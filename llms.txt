<!-- repo: team-michael/notifly-ios-sdk -->
<!-- ref: main -->
<!-- commit: d30fbaffdd2b0a111fc7de875566ae78cd742fde -->
<!-- generated_at: 2025-11-13T10:38:48Z -->
# Platform: iOS

## NotiflyIOSSample/NotiflyIOSSample
- [Notiflyiossampleapp](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyIOSSample/NotiflyIOSSampleApp.swift): Defines the SwiftUI @main app entry NotiflyIOSSampleApp that adapts AppDelegate (UIApplicationDelegateAdaptor), injects notifly_sdk, and assigns appDelegate.window from UIWindowScene on ContentView onAppear.
- [Appdelegate](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyIOSSample/AppDelegate.swift): Sample AppDelegate initializes Firebase and Notifly (projectId, credentials, userId), requests/handles APNs authorization/token, forwards UIApplication/UNUserNotificationCenter callbacks to Notifly, and routes "pushnotiflyios" deep links.
- [Deeplinkmanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyIOSSample/DeepLinkManager.swift): Singleton ObservableObject that parses incoming URLs via handleDeepLink(_:), logs components, extracts queryItems into deepLinkParameters (Published) on main thread only when name query starts with "deeplink".
- [Deeplinkview](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyIOSSample/DeepLinkView.swift): SwiftUI DeepLinkView (Identifiable) that displays URL parameters and onAppear calls handleDeepLink to open or present https://notifly.tech via UIApplication.
- [Contentview](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyIOSSample/ContentView.swift): SwiftUI ContentView demonstrating Notifly SDK: buttons call Notifly.trackEvent for push/popup events, handles onOpenURL via DeepLinkManager.

## NotiflyIOSSample/NotiflyNotificationExtension
- [Notificationservice](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyIOSSample/NotiflyNotificationExtension/NotificationService.swift): Subclass of NotiflyNotificationServiceExtension (uses notifly_sdk and UserNotifications) that calls register(projectId:username:) in init via setup() to configure SDK notification handling.

## NotiflyTestApp/NotiflyNotificationExtension
- [Notificationservice](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyNotificationExtension/NotificationService.swift): NotificationService subclasses NotiflyNotificationServiceExtension in the Notification Service Extension, initializes on creation and calls setup to register(projectId:username:) (uses TestConstant) for notifly push handling.

## NotiflyTestApp/NotiflyTestApp/SourceCodes
- [Testconstant](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/TestConstant.swift): Defines TestConstant enum providing static test credentials (username, password, projectID) for NotiflyTestApp, used by test flows and sample auth/project initialization.

## NotiflyTestApp/NotiflyTestApp/SourceCodes/UI
- [Trackingtestviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/TrackingTestViewController.swift): Test UIViewController that builds UI to craft tracking events, subscribes to Notifly.main.
- [Mainviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/MainViewController.swift): MainViewController builds the test UI (projectID/username/password inputs, token text views, CTA buttons), initializes Notifly on load, and navigates to Tracking/Push/UserSettings test VCs via button actions.
- [Pushnotificationtestviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/PushNotificationTestViewController.swift): UIViewController that builds a test UI to validate title/body/URL/delay, and (via scheduleNotificationWithCurrentIntputs triggered by scheduleBtnTapped) calls Notifly.schedulePushNotification; uses UI/helpers like addInputView and checkAndRetrieveValueText.
- [Appdelegate](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/AppDelegate.swift): AppDelegate uses Firebase and notifly_ios_sdk to request push permissions, configure Firebase, initialize Notifly with credentials, add in-app message listener, and forward APNs/UNNotificationCenter callbacks.
- [Usersettingstestviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/UserSettingsTestViewController.swift): Test UIViewController building inputs/buttons that validates timezone IDs, calls Notifly.setUserId/setPhoneNumber/setEmail/setTimezone/setUserProperties on taps, presents KeyValueDataInputViewController, and shows responses.
- [Scenedelegate](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/SceneDelegate.swift): UIWindowSceneDelegate implementing scene lifecycle and deep-link handling (scheme "pushnotiflyios", host "navigation") parsing "name" query via URLComponents to push/create UINavigationController and present specific test view controllers.

## NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/Util
- [Uistackview+](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/Util/UIStackView+.swift): UIStackView extension adding UIKit convenience methods (addInputView, addSwitchView, addCTAView, addInfoView, addSeparator) that create/configure controls, add arranged subviews, and activate width/height constraints.
- [Keyvaluedatainputviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/Util/KeyValueDataInputViewController.swift): UIViewController that renders a scrollable stack of dynamic key/value entry rows, validates pairs, exposes init(initialKeyValuePairs:) and saveAndDismiss(), and calls delegate keyValueDataInputVCWilComplete; uses UIKit and helper UI extensions.
- [Uitextfield+](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/NotiflyTestApp/NotiflyTestApp/SourceCodes/UI/Util/UITextField+.swift): UITextField extension adding checkAndRetrieveValueText(changeBorderColorOnError: Bool = true) -> String? (trims/validates non-empty) and UI helpers setToErrorUI/setToDefaultUI(borderColor: UIColor =.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/API
- [Notiflyapi+request](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/API/NotiflyAPI+Request.swift): Builder that constructs URLRequest with default headers (NotiflyHelper), sets Authorization/Bearer, encodes body, and fires URLSession publishers returning AnyPublisher<T,Error> (decoded Response.data) or raw JSON.
- [Notiflyapi](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/API/NotiflyAPI.swift): NotiflyAPI constructs and dispatches network requests (authorizeSession, trackEvent/retryTrackEvent, requestSyncState) using RequestBuilder and Combine, handling auth token injection, token-refresh on expiration, raw JSON responses, and logging.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Auth
- [Auth](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Auth/Auth.swift): Manages session authorization via NotiflyAPI using supplied Credentials, publishes/refreshes auth tokens (authorizationPub, refreshAuth()), persists tokens to NotiflyCustomUserDefaults, handles Combine promises, cancellables, and timeouts.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage
- [Userstate+constant](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/UserState+Constant.swift): Defines user, campaign and event state models and helpers for parsing, merging, clearing, and serializing in-app message state (UserData, CampaignData, EventData, EventIntermediateCount, EicHelper), depends on AppHelper, NotiflyHelper, and Notifly.userManager.
- [Inappmessage+constant](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/InAppMessage+Constant.swift): Defines in-app message constants and payload type (InAppMessageConstant, InAppMessageData) — including injected JS that posts to window.webkit.
- [Userstatemanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/UserStateManager.swift): Thread-safe manager for owner/campaign/user/event state using DispatchQueues; syncState calls NotiflyAPI via Combine, parses JSON into CampaignData/UserData/EventData, can reconcile external_user_id and update userManager, provides incrementEic, getters, updaters, and clear.
- [Inappmessagemanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/InAppMessageManager.swift): InAppMessageManager evaluates campaigns (UserStateManager, SegmentationHelper, TriggeringEventFilter, Notifly.main.
- [Segmentationhelper](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/SegmentationHelper.swift): SegmentationHelper determines if a Campaign's condition-based segment matches a user/event via isEntityOfSegment(..
- [Campaign](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/Campaign.swift): Parses and models in-app campaign payloads (Campaign.init?
- [Webviewmodalviewcontroller](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/InAppMessage/WebViewModalViewController.swift): WebViewModalViewController presents configurable WKWebView in-app message modals (init(notiflyInAppMessageData:)), handles JS message events, updates user hide-until state, tracks via Notifly, manages openedInAppMessageCount.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Notifications
- [Notificationsmanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Notifications/NotificationsManager.swift): NotificationsManager manages APNs/FCM token acquisition with a Combine-based deviceToken publisher, exponential backoff retries/timeouts, UIApplication registration callbacks, local notification scheduling, and UNUserNotificationCenterDelegate handling, using FirebaseMessaging and UIKit.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Tracking
- [Trackingmanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/Tracking/TrackingManager.swift): Combine-based manager that creates TrackingRecord/TrackingEvent from device/app IDs and APNs token, triggers in-app message checks, publishes payloads, sends to NotiflyAPI.trackEvent, and provides track(.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/User
- [Usermanager](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Infrastructures/User/UserManager.swift): Thread-safe manager for external/notifly user IDs: persists externalUserID, generates UUIDv5 notiflyUserID, updates/clears user state and properties, and triggers sync/tracking via Notifly.asyncWorker/Notifly.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Notifly
- [Notifly+helper](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Notifly/Notifly+Helper.swift): Utility helpers and comparators: NotiflyHelper provides SDK/version, date, event-name, hide-until and regex parsing; NotiflyValueComparator/NotiflyStringComparator perform typed value and string/operator comparisons; depends on NotiflySdkConfig, AppHelper, TimeConstant, Logger, NotiflyOperator/ValueType/StringOperator.
- [Notifly+publicapi](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Notifly/Notifly+PublicAPI.swift): Provides Notifly public SDK APIs: initialization (Firebase precheck, state sync, cold‑start push handling), UIApplication/UNUserNotificationCenter hooks, event/user property management, FCM token registration, scheduling, and in‑app message listeners.
- [Notifly](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/Notifly/Notifly.swift): Notifly.swift defines the Notifly singleton (setup(projectId,username,password); throwing main accessor), initializes Auth/managers, registers credentials in NotiflyCustomUserDefaults, exposes asyncWorker/coldStart flags and a thread-safe Combine cancellable store.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyExtension
- [Notiflyextensionapi](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyExtension/NotiflyExtensionAPI.swift): NotiflyExtensionAPI manages authorization caching via NotiflyCustomUserDefaults, builds/fires tracking HTTP requests (ExtensionRequestBuilder), parses JSON, retries once on 401, and exposes track(payload:completion:) as primary entry.
- [Notificationserviceextension](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyExtension/NotificationServiceExtension.swift): Handles push notification modification and tracking in extension: NotiflyNotificationServiceExtension overrides didReceive/serviceExtensionTimeWillExpire, register(projectId:username:); ExtensionManager fetches attachments, adds UNNotificationAttachment, and posts tracking via NotiflyExtensionAPI using NotiflyCustomUserDefaults/AppHelper.

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil
- [Constants](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/Constants.swift): Defines SDK-wide constants, endpoints, tracking keys, time units, value/operator/trigger enums and NotiflyValue struct (Foundation dependency) used for event tracking, serialization, and condition evaluation—no side effects.
- [Notiflyerror](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/NotiflyError.swift): Defines NotiflyError enum (Error) for SDK-wide error reporting of initialization, authorization, token (APNS/FCM/device), payload, timeout, and nil/unexpected-nil conditions; depends on Foundation.
- [Apphelper](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/AppHelper.swift): Provides app/device utilities: getNotiflyDeviceID/getDeviceID (Keychain fallback with UserDefaults caching), timestamp, app/version/platform identifiers; writes to Keychain/UserDefaults and depends on Security/UIKit and Notifly constants.
- [Logger](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/Logger.swift): Simple static console logger using Foundation with Logger.info(_:)/error(_:) printing tagged messages (error includes emoji), Level enum present; private init prevents instantiation.
- [Notiflycustomuserdefaults](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/NotiflyCustomUserDefaults.swift): Registers an app‑group UserDefaults (register(projectId:org:)) and provides static computed getters/setters that prefix keys with projectId for project/user/auth/device data and presence-based isRegisteredAPNs flag.
- [Timezone](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/Timezone.swift): TimezoneUtil provides two static helpers—getCurrentTimezoneId() returns TimeZone.current.
- [Messagedata](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/MessageData.swift): PushAttachment parses and validates a push attachment dictionary into typed properties (attachmentType, fileExtension, url) and maps extensions to kUTType CFString values via its throwing init(attachment:).
- [Asyncworker](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/AsyncWorker.swift): NotiflyAsyncWorker serializes async tasks using an internal DispatchSemaphore/DispatchQueue, exposing init(semaphoreValue:) and addTask(lockAcquired:task:) that provides a finishTask callback and signals the semaphore with tokenized 10s timeout.
- [Uuid+](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/UUID+.swift): Adds a UUID v5 initializer (name+namespace using CommonCrypto CC_SHA1, sets RFC 4122 version/variant bits) and a notiflyStyleString property returning a dashless uuidString.
- [Trackingevent](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/TrackingEvent.swift): Defines NotiflyApiRequestProtocol-conforming Codable request models and encoding logic for serializing tracking/auth payloads (ApiRequestBody, RequestPayload, TrackingEvent/Record, TrackingData) and SdkWrapperType; depends on Foundation and NotiflyAnyCodable.
- [Credentials](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/Credentials.swift): Defines a Codable Credentials struct (userName, password) used for serializing authentication payloads (JSON/Plist) in network requests; depends on Foundation, no side effects.
- [Anycodable](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdk/SourceCodes/NotiflyUtil/AnyCodable.swift): NotiflyAnyCodable is a Codable wrapper for heterogeneous Any values (nil, Bool, Int, Double, String, [Any?], [String:Any?

## Sources/Notifly/notifly-ios-sdk/notifly-ios-sdkTests
- [Notifly Ios Sdktests](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdkTests/notifly_ios_sdkTests.swift): XCTestCase subclass providing placeholder unit/performance tests for notifly_ios_sdk with setUpWithError/tearDownWithError hooks and example test methods; imports XCTest and @testable import notifly_ios_sdk.
- [Asyncworkerverbosesmoketests](https://raw.githubusercontent.com/team-michael/notifly-ios-sdk/main/Sources/Notifly/notifly-ios-sdk/notifly-ios-sdkTests/AsyncWorkerVerboseSmokeTests.swift): Verbose XCTest suite validating NotiflyAsyncWorker.addTask(lockAcquired:) using its finish callback, ensuring single active concurrency (no overlap), FIFO start order, finish-vs-timeout first‑wins, finish idempotency, nested lock no‑deadlock, and stress resilience.
